{"version":3,"file":"HttpApp.js","names":["Context","_interopRequireWildcard","require","Effect","Exit","Fiber","FiberRef","GlobalValue","Layer","Option","Runtime","Scope","Stream","_Unify","HttpBody","ServerError","ServerRequest","ServerResponse","internal","internalMiddleware","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","handledSymbol","Symbol","for","toHandled","self","handleResponse","middleware","responded","withFiberRuntime","fiber","flatMap","response","request","unsafeGet","currentContext","HttpServerRequest","handler","getFiberRef","currentPreResponseHandlers","_tag","as","tap","value","withErrorHandling","catchAllCause","cause","causeResponse","zipRight","failCause","withMiddleware","unify","undefined","tracer","matchCauseEffect","onFailure","void","_cause","empty","status","onSuccess","uninterruptible","scoped","exports","ejectDefaultScopeClose","scope","ejectedScopes","add","unsafeEjectStreamScope","body","getOrThrow","getCurrentFiber","setBody","stream","ensuring","close","contentType","contentLength","globalValue","WeakSet","effect","make","onExit","extend","exit","appendPreResponseHandler","withPreResponseHandler","toWebHandlerRuntime","runtime","run","runFork","resolveSymbol","httpApp","toWeb","withoutBody","method","context","Promise","resolve","contextMap","Map","unsafeMap","isContext","key","httpServerRequest","fromWeb","locally","unsafeMake","signal","addEventListener","unsafeInterruptAsFork","clientAbortFiberId","once","toWebHandler","defaultRuntime","toWebHandlerLayer","layer","runSync","runPromise","build","map","toRuntime","_","runner","then"],"sources":["../../src/HttpApp.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}