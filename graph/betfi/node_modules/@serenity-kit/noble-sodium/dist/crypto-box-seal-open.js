import { blake2b } from "@noble/hashes/blake2b";
import { crypto_box_NONCEBYTES, crypto_box_PUBLICKEYBYTES, } from "./constants.js";
import { cryptoBoxOpenEasy } from "./crypto-box-open-easy.js";
export function cryptoBoxSealOpen({ ciphertext, privateKey, publicKey, }) {
    const ephemeralPublicKey = ciphertext.slice(0, crypto_box_PUBLICKEYBYTES);
    const nonce = blake2b(new Uint8Array([...ephemeralPublicKey, ...publicKey]), {
        dkLen: crypto_box_NONCEBYTES,
    });
    const encryptedMessage = ciphertext.slice(crypto_box_PUBLICKEYBYTES);
    return cryptoBoxOpenEasy({
        ciphertext: encryptedMessage,
        nonce,
        publicKey: ephemeralPublicKey,
        privateKey,
    });
}
//# sourceMappingURL=crypto-box-seal-open.js.map